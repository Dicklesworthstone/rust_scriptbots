# Phase 2 WebAssembly TODOs (Codex, 2025-10-22)

- [x] Guard Rayon usage across wasm pathways
  - [x] Audit `scriptbots-core` and consumers for `#[cfg(feature = "parallel")]` coverage
  - [x] Ensure workspace avoids linking Rayon for wasm builds (crate features / dependency pruning)
  - [x] Add documentation note on disabling parallelism for wasm builds
- [x] Extend `scriptbots-web` data interchange options
  - [x] Add binary snapshot export (`postcard` or similar) alongside JSON
  - [x] Expose snapshot format toggle in `InitOptions`
  - [x] Document snapshot APIs in `web/README.md`
- [x] Improve brain selection ergonomics for wasm
  - [x] Allow JS callers to choose seeding strategy (`wander` vs `none`)
  - [x] Stub registration pathway for future `scriptbots-brain` bindings (documented opt-in)
- [x] Strengthen parity/regression tests
  - [x] Expand wasm-vs-native parity test across multiple seeds/ticks
  - [x] Add float tolerance helper (with diagnostics) reused across assertions
  - [x] Run parity test under `wasm-pack test --headless`
- [x] Integrate wasm tests into CI
  - [x] Update `.github/workflows/ci.yml` with `wasm-pack build` + headless Chrome job
  - [x] Install Chrome/Chromium on CI runner and cache wasm-pack artifacts
  - [x] Ensure job runs on PRs + main branch
- [x] Polish Canvas demo harness
  - [x] Add lightweight benchmarking log (FPS, TPS over time)
  - [x] Document serving instructions (without bundler) & add npm script/Make target
  - [x] Clarify reset/seed controls in UI and README
- [x] Update project docs
  - [x] Amend `PLAN_TO_CREATE_SIBLING_APP_CRATE_TARGETING_WASM.md` for new snapshot formats, brain options, CI steps
  - [x] Add brief note to `README.md` pointing to wasm harness
